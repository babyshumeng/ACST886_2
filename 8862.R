#####Q2
x<-c("40-44","45-49","50-54","55-59","60-64","65-69","70-74","75-79","80-84","85-89","90-94")
x
E_x<-c(15518,19428,21594,21890,19174,15775,11414,6993,3276,1096,201)
E_x
D_x<-c(65,144,219,378,465,557,685,644,471,217,67)
D_x
E_xq_x<-c(73.9,134.6,223.9,346.3,468.1,600.2,675.5,637.4,458.7,240.6,61.4)
E_xq_x
q_x<-E_xq_x/E_x
q_x
varDeath<-E_xq_x*(1-q_x)
varDeath
Z_x<-(D_x-E_xq_x)/sqrt(E_xq_x*(1-q_x))
Z_x
chi2<-(Z_x)^2
sum(chi2)
qchisq(0.95,11)
d<-c()
d[1]<-pnorm(-1)
d[2]<-pnorm(0)-pnorm(-1)
d[3]<-pnorm(1)-pnorm(0)
d[4]<-1-pnorm(1)
d
E<-11*d
E
A<-c()
A[1]<-sum(Z_x<(-1))
A[2]<-sum((Z_x>-1)*Z_x<(0))
A[3]<-sum((Z_x>0)*(Z_x<(1)))
A[4]<-sum(Z_x>1)
A
SDT<-sum((A-E)^2/E)
SDT
qchisq(0.95,3)
CDT<-sum(D_x-E_xq_x)/sqrt(sum(E_xq_x*(1-q_x)))
CDT
CDT<-abs(CDT)
qnorm(0.975)

sum((Z_x>0))
p<-2*pbinom(6,11,0.5)
p

Z_x
n_1<-6;
n_2<-5
j<-0
repeat{j<-j+1
k<-c(1:j)
if((sum(factorial(n_1-1)/factorial(k-1)/factorial(n_1-k)*factorial(n_2+1)/factorial(k)/factorial(n_2+1-k)))/(factorial(n_1+n_2)/factorial(n_1)/factorial(n_2))>=0.05){print(j)
  break}
}

Z_x
zbar_1=Z_x[1:10]
zbar_2=Z_x[2:11]
SCT<-sum((zbar_1-mean(zbar_1))*(zbar_2-mean(zbar_2)))/sqrt(sum((zbar_1-mean(zbar_1))^2)*sum((zbar_2-mean(zbar_2))^2))*sqrt(10)
SCT
qnorm(0.925)

